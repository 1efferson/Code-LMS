{% extends "base.html" %}

{% block title %}Course Catalog | Code-LMS{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('courses.static', filename='css/course_catalog.css') }}">
<script src="{{ url_for('static', filename='js/course_catalog.js') }}" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.11.2/lottie.min.js"></script>
{% endblock %}

{% block content %}

    <div class="level-nav">
        <a href="#beginner" id="beginner-link" class="nav-link">Beginner</a>
        <a href="#intermediate" id="intermediate-link" class="nav-link">Intermediate</a>
        <a href="#advanced" id="advanced-link" class="nav-link">Advanced</a>
    </div>

    <div class="catalog-container">

        <!-- BEGINNER LEVEL SECTION -->
        <section id="beginner" class="course-level-section">
            <div class="section-header">
                <h2>Beginner Level: Foundations</h2>
            </div>
            <div class="course-grid">
                
                {% for course in courses if course.level == 'Beginner' %}
                <div class="course-card" data-level="{{ course.level }}">
                    <div class="card-header beginner-header">{{ course.category or 'Programming' }}</div>
                    <div class="card-body">
                        <h3>{{ course.title }}</h3>
                        <p>{{ course.description or 'No description available.' }}</p>
                    </div>
                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}" class="enroll-btn enroll-btn-primary">
                            Start Now
                        </a>
                    </div>
                </div>
                {% endfor %}

            </div>
        </section>

        <!-- INTERMEDIATE LEVEL SECTION -->
        <section id="intermediate" class="course-level-section">
            <div class="section-header">
                <h2>Intermediate Level: Practical Application</h2>
            </div>
            <div class="course-grid">
                
                {% for course in courses if course.level == 'Intermediate' %}
                <div class="course-card" data-level="{{ course.level }}">
                    <div class="card-header intermediate-header">{{ course.category or 'Development' }}</div>
                    <div class="card-body">
                        <h3>{{ course.title }}</h3>
                        <p>{{ course.description or 'No description available.' }}</p>
                    </div>
                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}" class="enroll-btn enroll-btn-primary">
                            Enroll Now
                        </a>
                    </div>
                </div>
                {% endfor %}

            </div>
        </section>

        <!-- ADVANCED LEVEL SECTION -->
        <section id="advanced" class="course-level-section">
            <div class="section-header">
                <h2>Advanced Level: Full-Stack Development</h2>
            </div>
            <div class="course-grid">
                
                {% for course in courses if course.level == 'Advanced' %}
                <div class="course-card" data-level="{{ course.level }}">
                    <div class="card-header advanced-header">{{ course.category or 'Full-Stack' }}</div>
                    <div class="card-body">
                        <h3>{{ course.title }}</h3>
                        <p>{{ course.description or 'No description available.' }}</p>
                    </div>
                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}" class="enroll-btn enroll-btn-primary">
                            Enroll Now
                        </a>
                    </div>
                </div>
                {% endfor %}

            </div>
        </section>

    </div>

    <!-- STREAK CARD -->
    {% if current_user.is_authenticated %}
    <div id="streak-card" class="fixed bottom-6 right-6 w-64 bg-white/40 backdrop-blur-lg border border-white/20 rounded-xl shadow-lg p-4 flex items-center gap-4 animate-fadeIn animate-pop">
        <!-- Lottie container -->
        <div id="lottie-streak" class="w-16 h-16"></div>
        <div>
            <div class="text-sm text-gray-700 font-semibold">ðŸ”¥ Daily Streak</div>
            <div class="text-lg font-bold text-gray-900">{{ current_user.login_streak }} day{% if current_user.login_streak > 1 %}s{% endif %}</div>
        </div>
    </div>

    <script>
        lottie.loadAnimation({
            container: document.getElementById('lottie-streak'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '{{ url_for("static", filename="lottie/streak.json") }}'
        });
    </script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px);}
            to { opacity: 1; transform: translateY(0);}
        }
        @keyframes pop {
            0% { transform: scale(0); }
            60% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }
        .animate-pop { animation: pop 0.6s ease-out forwards; }
    </style>
    {% endif %}

{% endblock %}
