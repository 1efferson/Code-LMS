{% extends "base.html" %}

{% block title %}Course Catalog | Code-LMS{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('courses.static', filename='css/course_catalog.css') }}">
<script src="{{ url_for('static', filename='js/course_catalog.js') }}" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.11.2/lottie.min.js"></script>
{% endblock %}

{% block content %}

<!-- PAGE WRAPPER-->
<div class="bg-gray-100 dark:bg-gray-950
            text-gray-900 dark:text-gray-100
            transition-colors duration-300">

    <!-- LEVEL NAV -->
    <div class="level-nav
                bg-white dark:bg-gray-900
                border-b border-gray-200 dark:border-gray-800">
        <a href="#beginner" id="beginner-link"
           class="nav-link text-gray-700 dark:text-gray-300">
            Beginner
        </a>
        <a href="#intermediate" id="intermediate-link"
           class="nav-link text-gray-700 dark:text-gray-300">
            Intermediate
        </a>
        <a href="#advanced" id="advanced-link"
           class="nav-link text-gray-700 dark:text-gray-300">
            Advanced
        </a>
    </div>

    <!-- CATALOG -->
    <div class="catalog-container">

        <!-- BEGINNER -->
        <section id="beginner" class="course-level-section">
            <div class="section-header">
                <h2 class="text-gray-900 dark:text-gray-100">
                    Beginner Level: Foundations
                </h2>
            </div>

            <div class="course-grid">
                {% for course in courses if course.level == 'Beginner' %}
                <div class="course-card
                            bg-white dark:bg-gray-900
                            border border-gray-200 dark:border-gray-800
                            shadow-sm hover:shadow-md
                            transition"
                     data-level="{{ course.level }}">

                    <div class="card-header beginner-header
                                text-gray-800 dark:text-gray-100">
                        {{ course.category or 'Programming' }}
                    </div>

                    <div class="card-body">
                        <h3 class="text-gray-900 dark:text-white">
                            {{ course.title }}
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400">
                            {{ course.description or 'No description available.' }}
                        </p>
                    </div>

                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}"
                           class="enroll-btn enroll-btn-primary">
                            Start Now
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- INTERMEDIATE -->
        <section id="intermediate" class="course-level-section">
            <div class="section-header">
                <h2 class="text-gray-900 dark:text-gray-100">
                    Intermediate Level: Practical Application
                </h2>
            </div>

            <div class="course-grid">
                {% for course in courses if course.level == 'Intermediate' %}
                <div class="course-card
                            bg-white dark:bg-gray-900
                            border border-gray-200 dark:border-gray-800
                            shadow-sm hover:shadow-md
                            transition"
                     data-level="{{ course.level }}">

                    <div class="card-header intermediate-header
                                text-gray-800 dark:text-gray-100">
                        {{ course.category or 'Development' }}
                    </div>

                    <div class="card-body">
                        <h3 class="text-gray-900 dark:text-white">
                            {{ course.title }}
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400">
                            {{ course.description or 'No description available.' }}
                        </p>
                    </div>

                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}"
                           class="enroll-btn enroll-btn-primary">
                            Enroll Now
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- ADVANCED -->
        <section id="advanced" class="course-level-section">
            <div class="section-header">
                <h2 class="text-gray-900 dark:text-gray-100">
                    Advanced Level: Full-Stack Development
                </h2>
            </div>

            <div class="course-grid">
                {% for course in courses if course.level == 'Advanced' %}
                <div class="course-card
                            bg-white dark:bg-gray-900
                            border border-gray-200 dark:border-gray-800
                            shadow-sm hover:shadow-md
                            transition"
                     data-level="{{ course.level }}">

                    <div class="card-header advanced-header
                                text-gray-800 dark:text-gray-100">
                        {{ course.category or 'Full-Stack' }}
                    </div>

                    <div class="card-body">
                        <h3 class="text-gray-900 dark:text-white">
                            {{ course.title }}
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400">
                            {{ course.description or 'No description available.' }}
                        </p>
                    </div>

                    <div class="card-footer">
                        <a href="{{ url_for('courses.course_detail', slug=course.slug) }}"
                           class="enroll-btn enroll-btn-primary">
                            Enroll Now
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

    </div>

    <!-- STREAK CARD -->
    {% if current_user.is_authenticated %}
    <div id="streak-card"
         class="fixed bottom-6 right-6 w-64
                bg-white/70 dark:bg-gray-900/80
                backdrop-blur-lg
                border border-gray-200 dark:border-gray-800
                rounded-xl shadow-lg p-4
                flex items-center gap-4
                animate-fadeIn animate-pop z-40">

        <div id="lottie-streak" class="w-16 h-16"></div>

        <div>
            <div class="text-sm text-gray-700 dark:text-gray-300 font-semibold">
                ðŸ”¥ Daily Streak
            </div>
            <div class="text-lg font-bold text-gray-900 dark:text-white">
                {{ current_user.login_streak }} day{% if current_user.login_streak > 1 %}s{% endif %}
            </div>
        </div>
    </div>

    <script>
        lottie.loadAnimation({
            container: document.getElementById('lottie-streak'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '{{ url_for("courses.static", filename="lottie/streak.json") }}'
        });
    </script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pop {
            0% { transform: scale(0); }
            60% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }
        .animate-pop { animation: pop 0.6s ease-out forwards; }
    </style>
    {% endif %}

</div>
<!-- PAGE WRAPPER ENDS HERE -->
{% endblock %}